# 异常检测
- 根据已有数据对新的数据判断是否异常，类似不对称分类，异常样本少
- 一般方法是通过已有数据建立概率模型对新数据进行判断，低于特定值则异常 
- 在划分数据集上，训练集一般不包含异常没有标签，验证集和测试集包含异常有标签，可以使用验证集来确定特定值
- 可以使用精确率、召回率、F1值来评估模型

## 异常检测和监督学习
异常检测适用于大量正常样本和少量异常样本或者异常样本难以学习  
监督学习适用于大量正常样本和大量异常样本，比如我们将垃圾邮件作为监督学习的问题，因为这个问题有大量正常异常样本

## 特征选择和处理
特征选择一般先用一个简单粗暴的模型，观察出错样本，以此来确定需要的特征  
用可视化的方法观察特征是否符合高斯分布，如果明显不符合则可以转化为高斯分布（可以用取对数、根值等，本质是减缓Y的增长速度，从而接近高斯分布）


## 算法
第一种算法，假设特征独立
$$
p(x)=\prod_{j=1}^{n}\frac{1}{\sqrt{2\pi}\ \sigma_j}exp\left(-\frac{(x_j-u_j)^2}{2 \sigma_j^2}\right)
$$

第二种算法，使用多元高斯分布
$$
p(x;u,\Sigma) = \frac{1}{(2\pi)^\frac{n}{2}\vert\Sigma\vert^\frac{1}{2}}exp\left(-\frac{1}{2}(x-u)^T\Sigma^{-1}(x-u)\right) \ \Sigma为协方差矩阵
$$


### 特点
第一种算法计算简单，参数少，样本少且有相关性也可以得到还不错的结果，如果执行效果不佳，需要自己观察构建特征  
第二种算法计算复杂，参数多，需要的样本多(m远大于n)，不需要自己构建特征

## 自动编码器
异常检测中，如果[自动编码器](nerual_network.md)误差很大就说明有异常